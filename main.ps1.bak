$key = Read-Host 'Enter your Gemini API key (input hidden): ' -AsSecureString
$sysprompt = (Get-Content .\sysprompt.md)
$prompt = Read-Host 'Write your question: '
$body = "
{
    `"safetySettings`": [
        {
            `"category`": `"HARM_CATEGORY_HARASSMENT`",
            `"threshold`": `"BLOCK_MEDIUM_AND_ABOVE`"
        }
    ],
    `"generationConfig`": {},
    `"systemInstruction`": {
        `"parts`": [{ `"text`": `"$sysprompt`" }],
        `"role`": `"system`"
    },
    `"contents`": [
        {
            `"role`": `"user`",
            `"parts`": [
                {
                    `"text`": `"$prompt`"
                }
            ]
        }
    ]
}
"

$session = New-Object Microsoft.PowerShell.Commands.WebRequestSession
$session.UserAgent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"
Invoke-WebRequest -UseBasicParsing -Uri "https://generativelanguage.googleapis.com/v1beta/models/gemini-3-flash-preview:generateContent" `
    -Method "POST" `
    -WebSession $session `
    -Headers @{
    "authority"          = "generativelanguage.googleapis.com"
    "method"             = "POST"
    "path"               = "/v1beta/models/gemini-3-flash-preview:generateContent"
    "scheme"             = "https"
    "accept"             = "*/*"
    "accept-encoding"    = "gzip, deflate, br, zstd"
    "accept-language"    = "en-SA,en;q=0.9,ar-SA;q=0.8,ar;q=0.7,de-SA;q=0.6,de;q=0.5,es-EG;q=0.4,es;q=0.3,en-GB;q=0.2,en-US;q=0.1"
    "cache-control"      = "no-cache"
    "origin"             = "https://ourgoal.site"
    "pragma"             = "no-cache"
    "priority"           = "u=1, i"
    "referer"            = "https://ourgoal.site/"
    "sec-ch-ua"          = "`"Chromium`";v=`"142`", `"Google Chrome`";v=`"142`", `"Not_A Brand`";v=`"99`""
    "sec-ch-ua-mobile"   = "?0"
    "sec-ch-ua-platform" = "`"Windows`""
    "sec-fetch-dest"     = "empty"
    "sec-fetch-mode"     = "cors"
    "sec-fetch-site"     = "cross-site"
    "x-goog-api-client"  = "genai-js/0.24.1"
    "x-goog-api-key"     = $key
} `
    -ContentType "application/json" `
    -Body ([System.Text.Encoding]::UTF8.GetBytes($body))